
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")


local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local rootPart = character:WaitForChild("HumanoidRootPart")
local platform = workspace.Platform:WaitForChild("Plat")

local teleportEnabled = false
local autoClick = false

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoStatusGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")


local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 60)
frame.Position = UDim2.new(0, 15, 0, 15)
frame.BackgroundTransparency = 0.4
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Parent = screenGui


local autoBuyLabel = Instance.new("TextLabel")
autoBuyLabel.Size = UDim2.new(1, 0, 0.5, 0)
autoBuyLabel.Position = UDim2.new(0, 0, 0, 0)
autoBuyLabel.Text = "L AutoBuy: OFF"
autoBuyLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
autoBuyLabel.BackgroundTransparency = 1
autoBuyLabel.Font = Enum.Font.SourceSansBold
autoBuyLabel.TextSize = 20
autoBuyLabel.Parent = frame


local autoYutLabel = Instance.new("TextLabel")
autoYutLabel.Size = UDim2.new(1, 0, 0.5, 0)
autoYutLabel.Position = UDim2.new(0, 0, 0.5, 0)
autoYutLabel.Text = "P AutoYut: OFF"
autoYutLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
autoYutLabel.BackgroundTransparency = 1
autoYutLabel.Font = Enum.Font.SourceSansBold
autoYutLabel.TextSize = 20
autoYutLabel.Parent = frame


UserInputService.InputBegan:Connect(function(input, gp)
	if gp then return end

	if input.KeyCode == Enum.KeyCode.P then
		teleportEnabled = not teleportEnabled
		autoYutLabel.Text = "P AutoYut: " .. (teleportEnabled and "ON" or "OFF")
		autoYutLabel.TextColor3 = teleportEnabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
		print("P AutoYut " .. (teleportEnabled and "включен" or "выключен"))
	end

	if input.KeyCode == Enum.KeyCode.L then
		autoClick = not autoClick
		autoBuyLabel.Text = "L AutoBuy: " .. (autoClick and "ON" or "OFF")
		autoBuyLabel.TextColor3 = autoClick and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
		print("L AutoBuy " .. (autoClick and "включен" or "выключен"))
	end
end)


task.spawn(function()
	while task.wait(0.5) do
		if teleportEnabled then
			for _, yut in ipairs(platform:GetChildren()) do
				if yut:IsA("BasePart") and yut.Parent then
					rootPart.CFrame = CFrame.new(yut.Position + Vector3.new(0, 0, 0))
					task.wait(0.2)
				end
			end
		end
	end
end)


task.spawn(function()
	local event = ReplicatedStorage.Shared.Remotes.ShopRemotes:WaitForChild("BuyGacha")
	while task.wait(0.2) do
		if autoClick then
			-- Сначала x50
			event:FireServer("x50")
			task.wait(0.1)
			-- Потом 10
			event:FireServer("10")
		end
	end
end)


-- === Автоиспользование предметов (AutoUseYut) ===
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local AutoUseYutEvent = ReplicatedStorage.Shared.Remotes.InventoryRemotes:WaitForChild("UseItem")
local playerguiUse = player:WaitForChild("PlayerGui")
    .mainInterface.MainFrame.FrameHolder.InventoryFrame.ItemInventoryFrame.InfoHolder.UseButton

-- Переменная состояния
local autoUseEnabled = false

-- GUI-индикатор (создаётся если не было)
local screenGui = playerguiUse:FindFirstAncestorWhichIsA("ScreenGui")
local indicator = Instance.new("TextLabel")
indicator.Size = UDim2.new(0, 200, 0, 40)
indicator.Position = UDim2.new(0.5, -100, 0, 100)
indicator.BackgroundTransparency = 0.4
indicator.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
indicator.TextColor3 = Color3.fromRGB(255, 255, 255)
indicator.TextScaled = true
indicator.Font = Enum.Font.SourceSansBold
indicator.Text = "K AutoUseYut: OFF"
indicator.Parent = screenGui

-- Переключение кнопкой "K"
UserInputService.InputBegan:Connect(function(input, gp)
	if not gp and input.KeyCode == Enum.KeyCode.K then
		autoUseEnabled = not autoUseEnabled
		indicator.Text = "K AutoUseYut: " .. (autoUseEnabled and "ON" or "OFF")
		print("K AutoUseYut:", autoUseEnabled and "ON" or "OFF")
	end
end)

-- Основной цикл
task.spawn(function()
	while true do
		if autoUseEnabled then
			if playerguiUse and playerguiUse.Visible then
				-- Нажимаем кнопку
				pcall(function()
					playerguiUse:Activate()
				end)
				-- Отправляем событие на сервер
				pcall(function()
					AutoUseYutEvent:FireServer("Yut") -- аргумент можешь поменять, если другой ID
				end)
			end
		end
		task.wait(0.3)
	end
end)
